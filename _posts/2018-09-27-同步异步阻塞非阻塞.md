---
layout:     post
title:      同步 异步 阻塞 非阻塞
subtitle:   Synchronous Asynchronous Blocking Nonblocking  
date:       2018-09-27
author:     BY
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - Blog
---


## 前言

对待学习不能以糊弄的态度

## 正文

### 问题来源

同学总考我这个概念，总是自己糊弄自己就过去。理解的总是有偏差。

#### 本质

同步与异步是关于指令执行顺序的。  
阻塞非阻塞是关于线程与进程的。  
两者本身并没有必然的关联系。  

#### 同步与异步

同步是指代码调用IO操作时，必须等待IO操作完成才返回的调用方式。  
所谓同步，就是在发出一个*调用*时，在没有得到结果之前，该*调用*就不返回。但是一旦调用返回，就得到返回值了。换句话说，就是由*调用者*主动等待这个*调用*的结果。  
异步是指代码调用IO操作时，不必等IO操作完成就返回的调用方式。  
*调用*在发出之后，这个调用就直接返回了，所以没有返回结果。换句话说，当一个异步过程调用发出后，调用者不会立刻得到结果。而是在*调用*发出后，*被调用者*通过状态、通知来通知调用者，或通过回调函数处理这个调用。  

同步是最原始的调用方式。  
异步则需要多线程，多CPU或者非阻塞IO的支持。  

#### 阻塞与非阻塞

阻塞调用是指调用结果返回之前，当前线程会被挂起。调用线程只有在得到结果之后才会返回。
非阻塞调用指在不能立刻得到结果之前，该调用不会阻塞当前线程。

#### 举例：

出场人物：老张，水壶两把（普通水壶，简称水壶；会响的水壶，简称响水壶）。  
老王想了想，有好几种等待方式   
1.老王用水壶煮水，并且站在那里，不管水开没开，每隔一定时间看看水开了没。－同步阻塞  
老王想了想，这种方法不够聪明。  
2.老王还是用水壶煮水，不再傻傻的站在那里看水开，跑去寝室上网，但是还是会每隔一段时间过来看看水开了没有，水没有开就走人。－同步非阻塞  
老王想了想，现在的方法聪明了些，但是还是不够好。  
3.老王这次使用高大上的响水壶来煮水，站在那里，但是不会再每隔一段时间去看水开，而是等水开了，水壶会自动的通知他。－异步阻塞  
老王想了想，不会呀，既然水壶可以通知我，那我为什么还要傻傻的站在那里等呢，嗯，得换个方法。  
4.老王还是使用响水壶煮水，跑到客厅上网去，等着响水壶自己把水煮熟了以后通知他。－异步非阻塞  
老王豁然，这下感觉轻松了很多。

#### 总结：

阻塞、非阻塞、多路IO复用，都是同步IO，异步必定是非阻塞的，所以不存在异步阻塞和异步非阻塞的说法。真正的异步IO需要CPU的深度参与。换句话说，只有用户线程在操作IO的时候根本不去考虑IO的执行全部都交给CPU去完成，而自己只等待一个完成信号的时候，才是真正的异步IO。所以，拉一个子线程去轮询、去死循环，或者使用select、poll、epool，都不是异步。

## 结语
查漏补缺。
